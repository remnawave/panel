---
sidebar_position: 2
title: Troubleshooting
---

## Subscription Page

### 502 Bad Gateway on subscription page {#502-bad-gateway-subscription-page}

#### Problem

When navigating to the subscription page domain, a 502 Bad Gateway error is returned.

#### Why this happens

This error occurs for the following reasons:

- Incorrect URL path — the root domain is opened without the subscription UUID
- Reverse proxy is not forwarding requests to the subscription page container
- Invalid environment variables
- DNS is not pointing to the correct IP
- Subscription page container is unavailable
- Incorrect timeouts in reverse proxy configuration
- Firewall/WAF blocking

#### Solution

1. Use the correct URL format:

```
https://sub.example.com/<shortUuid>
```

2. Ensure that the reverse proxy forwards traffic to `remnawave-subscription-page:3010`.

3. Check the subscription page container logs:

```bash
docker compose logs -t -f
```

4. Verify the `SUB_PUBLIC_DOMAIN` value in the panel's `.env` file. After editing, restart the panel container.

5. Ensure that DNS points to the correct IP.

6. Check the availability of the subscription container/backend.

7. Verify timeouts in the reverse proxy configuration.

8. Check firewall/WAF rules.

---

## Remnawave Panel

### "timeout of 45000ms exceeded" in panel {#timeout-45000ms-exceeded}

#### Problem

A timeout error message appears in the panel interface during node operations.

#### Why this happens

This error occurs for the following reasons:

- Panel cannot connect to the node's REST API on the specified port
- Blocking or high latency between panel and node
- Node environment variables do not match panel settings

#### Solution

1. Ensure that the `Node Port` value on the node matches the port used when generating docker-compose for the panel.

2. From the panel host, check the availability of the node port (telnet/curl).

3. Ensure stable network connectivity. If possible, place the node on a server with a reliable connection.

4. For complex topologies, consider tunneling between the panel and node (e.g., using Tailscale).

5. Verify that the node's environment variables match the panel settings.

6. Review the node container logs:

```bash
docker compose logs -f -t
```

7. Ensure the node started without port binding errors.

### 502 after panel upgrade {#502-after-panel-upgrade}

#### Problem

After upgrading the panel, some requests return a 502 error.

#### Why this happens

Nginx has not reloaded and has not picked up the new address from the panel.

#### Solution

1. Follow the Upgrading section in the documentation.

2. Restart the panel and dependent services.

3. Ensure containers are using updated images.

4. If the reverse proxy runs separately, restart it.

5. Verify that the proxy configuration still points to the correct containers/networks.

### Telegram OAuth: "domain invalid" {#telegram-oauth-domain-invalid}

#### Problem

When attempting to authenticate via Telegram, a "domain invalid" error appears.

#### Solution

1. Open @BotFather → Bot Settings → Domain.

2. Specify the panel domain:

```
https://panel.domain.com
```

3. Save settings in the panel: Settings → Telegram.

:::caution
Telegram OAuth does not support domains in the `.xyz` TLD.
:::

### Collation errors after PostgreSQL upgrade {#collation-errors-after-postgresql-upgrade}

#### Problem

After a major PostgreSQL upgrade, errors related to database collation occur.

#### Why this happens

Such errors most often appear when changing PostgreSQL major versions, when the old database's collations do not match those required by the new version.

#### Solution

1. Open the panel container:

```bash
docker exec -it remnawave remnawave
```

2. In the rescue CLI, execute the action:

```
● Fix Collation (Fix Collation issues for current database)
```

3. Restart the panel:

```bash
docker compose down && docker compose up -d
```

---

## Remnawave Node

### ECONNREFUSED after node reinstall {#econnrefused-after-node-reinstall}

#### Problem

The panel cannot connect to the node. ECONNREFUSED error appears in logs.

#### Solution

1. Ensure that the node parameters match those generated by the panel.

2. Confirm the correctness of `Node Port`.

3. Review the logs:

```bash
docker compose logs -f -t
```

4. Ensure there are no port binding errors and that the port is accessible.

5. Check `REMNAWAVE_PANEL_URL` for the subscription page — it should point to a reachable panel domain or internal service. If the subscription page is installed alongside Remnawave, use `http://remnawave-subscription-page:3010`.

### XML-RPC fault: SPAWN_ERROR: xray {#xml-rpc-fault-spawn-error-xray}

#### Problem

The following error appears in the node logs:

```title="cd /opt/remnanode && docker compose logs -f -t"
remnanode  | ERROR [HttpExceptionFilter]      Failed to get system stats - { stack: [ null ], code: 'A010', path: '/node/stats/get-system-stats' }
remnanode  | LOG [XrayService]      Getting config checksum...
remnanode  | LOG [XrayService]      XTLS config generated in: 1ms
// highlight-next-line-red
remnanode  | ERROR [XrayService]      XML-RPC fault: SPAWN_ERROR: xray - { stack: [ null ] }
remnanode  | LOG [XrayService]      Start XTLS took: 2s 568ms
remnanode  | ERROR [StatsService]     Failed to get system stats: /xray.app.stats.command.StatsService/GetSysStats UNAVAILABLE: No connection established. Last error: connect ECONNREFUSED 127.0.0.1:61000 (2025-05-08T14:36:08.821Z) - { stack: [ null ], isOk: false, code: 'A002' }
```

#### Why this happens

This error occurs when Xray core fails to start due to incorrect configuration.

#### Solution

1. Check the **Xray core** logs for detailed information:

```bash
docker exec -it remnanode tail -n +1 -f /var/log/supervisor/xray.out.log
```

or

```bash
docker exec -it remnanode tail -n +1 -f /var/log/supervisor/xray.err.log
```

2. In most cases, the logs will indicate the reason why Xray core is not starting.

3. Fix the issue in the Remnawave panel in the **Xray Config** section. Save the changes.

---

## Key Environment Variables

Panel configuration:

```bash
# Panel domain for CORS/UI
FRONT_END_DOMAIN=panel.yourdomain.com

# Public URL of subscription page
SUB_PUBLIC_DOMAIN=sub.yourdomain.com
```

Subscription page:

```bash
# Custom subscription prefix (optional)
CUSTOM_SUB_PREFIX=/custom-path

# Panel URL for API access
REMNAWAVE_PANEL_URL=https://panel.yourdomain.com
```

Additional options:

```bash
# Enable API documentation
IS_DOCS_ENABLED=true
SWAGGER_PATH=/swagger
SCALAR_PATH=/scalar

# Prometheus metrics
METRICS_USER=admin
METRICS_PASS=password
```

:::caution
After changing environment variables, restart the corresponding services.
:::

---

## Quick Diagnostic Checklist

For 502 errors:

- [ ] DNS resolves to the correct IP
- [ ] Backend container is running
- [ ] Reverse proxy configuration is correct
- [ ] Service is accessible via the correct path (domain vs subpath)
- [ ] Proxy timeouts are configured adequately
- [ ] Environment variables are set correctly
- [ ] Services have been restarted after changes

If node status is CONNECTED but functionality doesn't work:

- [ ] Ensure nodes are in CONNECTED status (UI + logs)
- [ ] Verify node configuration correctness: servernames, target, dest, etc.
- [ ] Ensure target addresses/ports are accessible from the node host
- [ ] Check panel settings:
  - [ ] User is assigned to Internal Squad
  - [ ] Internal Squad has enabled Inbounds (taken from Config Profile)
  - [ ] Internal squad/hosts are properly assigned and active
- [ ] Check that there are no overrides on the host in Advanced (Advanced → Overrides)
- [ ] After changes in Hosts or Internal Squads, update subscriptions in client applications
- [ ] Review node logs for WARN/ERROR regarding routing, TLS, DNS, and authentication
- [ ] Check local firewall rules on the node host

For timeouts:

- [ ] Node Port matches in both panel and node configuration
- [ ] Panel can reach the node port (telnet/curl)
- [ ] Node container is running
- [ ] Network connection is stable
- [ ] No firewall blocking between panel and node

For Telegram OAuth issues:

- [ ] Domain is correctly configured in BotFather
- [ ] Using a supported domain zone (not `.xyz`)
- [ ] Settings are saved in the panel

---

## Additional Resources

- Installation guide: [https://remna.st/docs/overview/quick-start/](https://remna.st/docs/overview/quick-start/)
- Panel usage instructions: [https://remna.st/blog/learn](https://remna.st/blog/learn)
- Panel installation: [https://remna.st/docs/install/remnawave-panel/](https://remna.st/docs/install/remnawave-panel/)
- Node installation: [https://remna.st/docs/install/remnawave-node/](https://remna.st/docs/install/remnawave-node/)
- Subscription page setup: [https://remna.st/docs/install/subscription-page/bundled/](https://remna.st/docs/install/subscription-page/bundled/)
- Environment variables: [https://remna.st/docs/install/environment-variables/](https://remna.st/docs/install/environment-variables/)
- Upgrade guide: [https://remna.st/docs/install/upgrading/](https://remna.st/docs/install/upgrading/)
- API documentation: [https://remna.st/api/](https://remna.st/api/)
- Telegram channel: [https://t.me/s/remnawave](https://t.me/s/remnawave)
- GitHub Issues: [https://github.com/remnawave/panel/issues](https://github.com/remnawave/panel/issues)
