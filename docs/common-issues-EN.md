# Troubleshooting

This section contains frequently encountered issues when operating the Remnawave panel, their symptoms, and step-by-step instructions for diagnosis and resolution. For each problem, symptoms, probable causes, and practical checks are provided.

---

## 502 Bad Gateway on Subscription Page

### Symptoms

- When navigating to the subscription page domain, a 502 Bad Gateway error is returned.
- Subscription page links don't work or return a server error.

### Common Causes and Solutions

1. Incorrect URL Path
   - Problem: You're opening the root domain without the subscription UUID.
   - Solution: Use the format:
     ```
     https://sub.example.com/<shortUuid>
     ```

2. Reverse Proxy Configuration
   - Problem: Proxy doesn't forward requests to the subscription page container.
   - Solution: Ensure the proxy directs traffic to `remnawave-subscription-page:3010`.
   - Check: View subscription page container logs:
     ```bash
     docker compose logs
     ```

3. Environment Variables
   - Check the `SUB_PUBLIC_DOMAIN` value in the panel's `.env` file.
   - Restart the panel container after changes.

4. General 502 Checks
   - Ensure DNS points to the correct IP.
   - Verify subscription container/backend availability.
   - Check timeouts in reverse proxy configuration.
   - Check firewall/WAF rules.

---

## "timeout of 45000ms exceeded" in Panel

### Symptoms

- A timeout error message appears in the panel interface during node operations (e.g., getting status or management).

### Common Causes and Solutions

1. Incorrect Node Port Configuration
   - Problem: Panel cannot connect to the node's REST API on the specified port.
   - Solution: Ensure the `Node Port` value on the node matches the port used when generating docker-compose for the panel.
   - Check: From the panel host, verify node port accessibility (telnet/curl).

2. Network Issues
   - Problem: Blocking/high latency between panel and node.
   - Solution: Ensure stable network connection; if possible, place the node on a server with a reliable channel.
   - Option: For complex topologies, consider Cloudflare Tunnel.

3. Node Configuration
   - Verify node environment variables match panel settings.
   - Review node container logs:
     ```bash
     docker compose logs -f -t
     ```
   - Ensure the node started without port binding errors.

### Quick Checklist

- [ ] Active squad selected in user profile.
- [ ] Internal squad has assigned inbounds.
- [ ] At least one host exists and is enabled.
- [ ] Host is linked to an inbound assigned to the squad.

---

## 502 After Panel Update

### Symptoms

- After updating the panel, some requests return 502.

### Solutions

1. Restart Services
   - Follow the Upgrading section in the documentation.
   - Restart panel and dependent services.
   - Ensure containers use updated images.

2. Reverse Proxy
   - If proxy runs separately, restart it.
   - Verify its configuration still points to correct containers/networks.

---

## Telegram OAuth: "domain invalid"

### Symptoms

- "domain invalid" error appears when attempting Telegram authorization.
- OAuth fails validation.

### Solution

1. Domain Setup in BotFather
   - Open @BotFather → Bot Settings → Domain.
   - Specify the panel domain, for example:
     ```
     https://panel.domain.com
     ```
   - Save settings in panel: Settings → Telegram.

2. Telegram Limitations
   - Important: Telegram OAuth doesn't support `.xyz` domains. Use `.com`, `.net`, `.org`, etc.
   - Incorrect domain will cause OAuth verification failure.

---

## ECONNREFUSED After Node Reinstallation

### Symptoms

- Panel cannot connect to node; ECONNREFUSED in logs.

### Solutions

1. Check Environment Variables
   - Ensure node parameters match those generated by the panel.
   - Confirm correct `Node Port`.

2. Restart and Check Node
   - Restart the node:
     ```bash
     docker compose down && docker compose up -d
     ```
   - View logs:
     ```bash
     docker compose logs -f -t
     ```
   - Ensure no port binding errors and port availability.

3. Panel URL Configuration
   - Check `REMNAWAVE_PANEL_URL` for subscription page — it should point to a reachable panel domain or internal service.

---

## Collation Errors After PostgreSQL Update

### Symptoms

- After a major PostgreSQL update, database collation errors occur.

### Solution (rescue CLI)

1. Open panel container:
   ```bash
   docker exec -it remnawave remnawave
   ```
2. Execute action in rescue CLI:
   ```
   ● Fix Collation (Fix Collation issues for current database)
   ```
3. Restart panel:
   ```bash
   docker compose down && docker compose up -d
   ```

Note: Such errors commonly appear when changing PostgreSQL major versions, when old database collations don't match new version requirements.

---

## Key Environment Variables

Panel configuration:

```bash
# Panel domain for CORS/UI
FRONT_END_DOMAIN=panel.yourdomain.com

# Public URL for subscription page
SUB_PUBLIC_DOMAIN=sub.yourdomain.com
# or for bundled installation:
# SUB_PUBLIC_DOMAIN=panel.yourdomain.com/api/sub
```

Subscription page:

```bash
# Custom subscription prefix (optional)
CUSTOM_SUB_PREFIX=/custom-path

# Panel URL for API access
REMNAWAVE_PANEL_URL=https://panel.yourdomain.com
```

Additional options:

```bash
# Enable API documentation
IS_DOCS_ENABLED=true
SWAGGER_PATH=/swagger
SCALAR_PATH=/scalar

# Prometheus metrics
METRICS_USER=admin
METRICS_PASS=password
```

Important: Restart corresponding services after changing environment variables.

---

## Quick Diagnostic Checklist

For 502:
- [ ] DNS resolves to correct IP.
- [ ] Backend container is running.
- [ ] Reverse proxy configuration is correct.
- [ ] Service is accessible via correct path (domain vs subpath).
- [ ] Proxy timeouts are adequately configured.
- [ ] Environment variables are set correctly.
- [ ] Services restarted after changes.

If node status is CONNECTED but functionality doesn't work:
- [ ] Ensure nodes are in CONNECTED status (UI + logs).
- [ ] Check correct node configuration: servernames, target, dest, etc.
- [ ] Ensure target addresses/ports are accessible from node host.
- [ ] Check panel settings specific to node operation:
  - [ ] User assigned to Internal Squad.
  - [ ] Internal Squad has enabled Inbounds (from Config Profile).
  - [ ] Internal squad/hosts correctly assigned and active.
- [ ] Check that host has no overrides in Advanced (Advanced → Overrides).
- [ ] After changes in Hosts or Internal Squads, update subscriptions in client applications.
- [ ] Review node logs for WARN/ERROR regarding routing, TLS, DNS, and authentication.
- [ ] Check local firewall rules on node host.

For timeouts:
- [ ] Node Port matches in panel and node configuration.
- [ ] Panel can reach node port (telnet/curl).
- [ ] Node container is running.
- [ ] Network connection is stable.
- [ ] No firewall blocks between panel and node.

For Telegram OAuth issues:
- [ ] Domain correctly configured in BotFather.
- [ ] Using supported domain zone (not `.xyz`).
- [ ] Settings saved in panel.

---

## Additional Resources

- Installation Guide: https://remna.st/docs/overview/quick-start/
- Panel Usage Instructions: https://remna.st/blog/learn
- Panel Installation: https://remna.st/docs/install/remnawave-panel/
- Node Installation: https://remna.st/docs/install/remnawave-node/
- Subscription Page Setup: https://remna.st/docs/install/subscription-page/bundled/
- Environment Variables: https://remna.st/docs/install/environment-variables/
- Upgrade Guide: https://remna.st/docs/install/upgrading/
- API Documentation: https://remna.st/api/
- Telegram Channel: https://t.me/s/remnawave
- GitHub Issues: https://github.com/remnawave/panel/issues
