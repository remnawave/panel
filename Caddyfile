# global options
{
	admin off
	persist_config off
	auto_https off
	# log {
	#	format json
	# }
	servers {
		trusted_proxies static private_ranges 100.0.0.0/8
	}
}

:{$PORT:8080} {
	handle /health {
		respond "OK" 200
	}

	handle @notMainDomain {
		not header Host docs.rw
		redir https://docs.rw{uri} permanent
	}

	handle {
		root * /app/build
		encode gzip
		try_files {path} /index.html
		file_server

		header {
			X-Content-Type-Options "nosniff"
			X-Frame-Options "DENY"
			X-XSS-Protection "1; mode=block"
		}
	}
}
